---
title: istio.authentication.v1alpha1
layout: protoc-gen-docs
---
<h2 id="Destination">Destination</h2>
<section>
<table>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
<tr id="Destination.name">
<td><code>name</code></td>
<td><code>string</code></td>
<td>
<p>REQUIRED. The name can be a short name or a fully qualified domain
name from the service registry, a resolvable DNS name, or an IP
address.
If short names are used, the FQDN of the service will be resolved in a
platform specific manner.</p>

</td>
</tr>
<tr id="Destination.ports">
<td><code>ports</code></td>
<td><code>uint32[]</code></td>
<td>
<p>Optional. List of ports that service are exposed on. Leave blank to applied
to all ports.</p>

</td>
</tr>
</table>
</section>
<h2 id="JWT">JWT</h2>
<section>
<p>JSON Web Token (JWT) token format for authentication as defined by
https://tools.ietf.org/html/rfc7519. See <a href="https://tools.ietf.org/html/rfc6749">OAuth
2.0</a> and <a href="http://openid.net/connect">OIDC
1.0</a> for how this is used in the whole
authentication flow.</p>

<p>Example,</p>

<pre><code>issuer: https://example.com
audiences:
- bookstore_android.apps.googleusercontent.com
  bookstore_web.apps.googleusercontent.com
jwks_uri: https://example.com/.well-known/jwks.json
</code></pre>

<table>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
<tr id="JWT.issuer">
<td><code>issuer</code></td>
<td><code>string</code></td>
<td>
<p>Identifies the principal that issued the JWT. See
https://tools.ietf.org/html/rfc7519#section-4.1.1
Usually a URL or an email address.</p>

<p>Example: https://securetoken.google.com
Example: 1234567-compute@developer.gserviceaccount.com</p>

</td>
</tr>
<tr id="JWT.audiences">
<td><code>audiences</code></td>
<td><code>string[]</code></td>
<td>
<p>The list of JWT
<a href="https://tools.ietf.org/html/rfc7519#section-4.1.3">audiences</a>.
that are allowed to access. A JWT containing any of these
audiences will be accepted.</p>

<p>The service name will be accepted if audiences is empty.</p>

<p>Example:</p>

<pre><code>audiences:
- bookstore_android.apps.googleusercontent.com
  bookstore_web.apps.googleusercontent.com
</code></pre>

</td>
</tr>
<tr id="JWT.jwks_uri">
<td><code>jwksUri</code></td>
<td><code>string</code></td>
<td>
<p>URL of the provider&rsquo;s public key set to validate signature of the
JWT. See <a href="https://openid.net/specs/openid-connect-discovery-1_0.html#ProviderMetadata">OpenID Discovery</a>.</p>

<p>Optional if the key set document can either (a) be retrieved from
<a href="https://openid.net/specs/openid-connect-discovery-1_0.html">OpenID Discovery</a>
of the issuer or (b) inferred from the email domain of the issuer
(e.g. a Google service account).</p>

<p>Example: https://www.googleapis.com/oauth2/v1/certs</p>

</td>
</tr>
<tr id="JWT.locations">
<td><code>locations</code></td>
<td><code><a href="#JWT.Location">JWT.Location[]</a></code></td>
<td>
</td>
</tr>
</table>
</section>
<h2 id="JWT.Location">JWT.Location</h2>
<section>
<p>Defines where to extract the JWT from an HTTP request.</p>

<p>If no explicit location is specified the following default
locations are tried in order:</p>

<pre><code>1) The Authorization header using the Bearer schema,
   e.g. Authorization: Bearer &lt;token&gt;. (see
   https://tools.ietf.org/html/rfc6750#section-2.1)

2) `access_token` query parameter (see
https://tools.ietf.org/html/rfc6750#section-2.3)
</code></pre>

<table>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
<tr id="JWT.Location.header" class="oneof oneof-start">
<td><code>header</code></td>
<td><code>string (oneof)</code></td>
<td>
<p>JWT is sent in a request header. <code>header</code> represents the
header name.</p>

<p>For example, if <code>header=x-goog-iap-jwt-assertion</code>, the header
format will be x-goog-iap-jwt-assertion: <JWT>.</p>

</td>
</tr>
<tr id="JWT.Location.query" class="oneof">
<td><code>query</code></td>
<td><code>string (oneof)</code></td>
<td>
<p>JWT is sent in a query parameter. <code>query</code> represents the
query parameter name.</p>

<p>For example, <code>query=jwt_token</code>.</p>

</td>
</tr>
</table>
</section>
<h2 id="Mechanism">Mechanism</h2>
<section>
<p>AuthenticationMechanism defines one particular type of authentication (i.e
mutual TLS, JWT etc). The type can be progammatically determine by checking
the type of the &ldquo;params&rdquo; field.</p>

<table>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
<tr id="Mechanism.none" class="oneof oneof-start">
<td><code>none</code></td>
<td><code><a href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#empty">google.protobuf.Empty (oneof)</a></code></td>
<td>
</td>
</tr>
<tr id="Mechanism.mtls" class="oneof">
<td><code>mtls</code></td>
<td><code><a href="#MutualTLS">MutualTLS (oneof)</a></code></td>
<td>
</td>
</tr>
<tr id="Mechanism.jwt" class="oneof">
<td><code>jwt</code></td>
<td><code><a href="#JWT">JWT (oneof)</a></code></td>
<td>
</td>
</tr>
</table>
</section>
<h2 id="MutualTLS">MutualTLS</h2>
<section>
<p>Placer holder for mTLS authentication params.</p>

</section>
<h2 id="Policy">Policy</h2>
<section>
<p>AuthenticationPolicy binds credentials to workload(s).
Authentication policy is composed of 2-part authentication:
- peer: verify caller service credentials.
- end_user: verify end-user credentials.
For each part, if it&rsquo;s not empty, at least one of those listed credential
must be provided and  (successfully) verified for the authentication to pass.</p>

<p>Examples:
Policy to enable mTLS for all services in namespace frod</p>

<pre><code>apiVersion: config.istio.io/v1alpha2
kind: RouteRule
metadata:
  name: mTLS-enable
  namespace: frod
spec:
  match:
  peer:
  - mtls: {}
</code></pre>

<p>Policy to enable mTLS, and use JWT for productpage:9000</p>

<pre><code>apiVersion: config.istio.io/v1alpha2
kind: RouteRule
metadata:
  name: mTLS-enable
  namespace: frod
spec:
  match:
  - name: productpage
    ports:
    - 9000
  peer:
  - mtls:
  end_user:
  - jwt:
      issuer: &quot;https://securetoken.google.com&quot;
      audiences:
      - &quot;productpage&quot;
      jwks_uri: &quot;https://www.googleapis.com/oauth2/v1/certs&quot;
      locations:
      - header: x-goog-iap-jwt-assertion
</code></pre>

<table>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
<tr id="Policy.match">
<td><code>match</code></td>
<td><code><a href="#Destination">Destination[]</a></code></td>
<td>
<p>List of destinations (workloads) that the policy should be applied on.
If empty, policy will be used on all destinations in the same namespace.</p>

</td>
</tr>
<tr id="Policy.peers">
<td><code>peers</code></td>
<td><code><a href="#Mechanism">Mechanism[]</a></code></td>
<td>
<p>List of credential that should be checked by peer authentication. They
will be validated in sequence, until the first one satisfied. If none of
the specified mechanism valid, the whole authentication should fail.
On the other hand, the first valid credential will be used to extract
peer identity (i.e the source.user attribute in the request to mixer).</p>

</td>
</tr>
<tr id="Policy.end_users">
<td><code>endUsers</code></td>
<td><code><a href="#Mechanism">Mechanism[]</a></code></td>
<td>
<p>Similar to above, but for end_user authentication, which will extract
request.auth.principal/audiences/presenter if authentication succeed.</p>

</td>
</tr>
</table>
</section>
