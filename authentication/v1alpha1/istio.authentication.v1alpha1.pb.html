---
title: Authentication Policy
overview: Authentication policy for Istio services.
layout: protoc-gen-docs
---
<h2 id="AuthenticationMechanism">AuthenticationMechanism</h2>
<section>
<p>AuthenticaitonMechanism defines one particular type of authentication, e.g
mutual TLS, JWT etc, (no authentication is one type by itsefl).
The type can be progammatically determine by checking the type of the
&ldquo;params&rdquo; field.</p>

<table>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
<tr id="AuthenticationMechanism.none" class="oneof oneof-start">
<td><code>none</code></td>
<td><code><a href="#None">None (oneof)</a></code></td>
<td>
</td>
</tr>
<tr id="AuthenticationMechanism.mtls" class="oneof">
<td><code>mtls</code></td>
<td><code><a href="#MutualTls">MutualTls (oneof)</a></code></td>
<td>
</td>
</tr>
<tr id="AuthenticationMechanism.jwt" class="oneof">
<td><code>jwt</code></td>
<td><code><a href="#Jwt">Jwt (oneof)</a></code></td>
<td>
</td>
</tr>
</table>
</section>
<h2 id="AuthenticationPolicy">AuthenticationPolicy</h2>
<section>
<p>AuthenticationPolicy binds credentials to workload(s).
Authentication policy is composed of 2-part authentication:
- peer: verify caller service credentials.
- end_user: verify end-user credentials.
For each part, if it&rsquo;s not empty, at least one of those listed credential
must be provided and  (successfully) verified for the authentication to pass.</p>

<p>Examples:
Policy to enable mTLS for all services in namespace frod</p>

<pre><code>apiVersion: config.istio.io/v1alpha1
kind: AuthenticationPolicy
metadata:
  name: mTLS-enable
  namespace: frod
spec:
  match:
  peers:
  - mtls: {}
</code></pre>

<p>Policy to enable mTLS, and use JWT for productpage:9000</p>

<pre><code>apiVersion: config.istio.io/v1alpha1
kind: AuthenticationPolicy
metadata:
  name: mTLS-enable
  namespace: frod
spec:
  match:
  - name: productpage
    port:
      number: 9000
  peers:
  - mtls:
  endUsers:
  - jwt:
      issuer: &quot;https://securetoken.google.com&quot;
      audiences:
      - &quot;productpage&quot;
      jwksUri: &quot;https://www.googleapis.com/oauth2/v1/certs&quot;
      locations:
      - header: x-goog-iap-jwt-assertion
</code></pre>

<table>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
<tr id="AuthenticationPolicy.match">
<td><code>match</code></td>
<td><code><a href="https://istio.io/docs/reference/config/istio.routing.v1alpha2.html#Destination">istio.routing.v1alpha2.Destination[]</a></code></td>
<td>
<p>List of destinations (workloads) that the policy should be applied on.
If empty, policy will be used on all destinations in the same namespace.</p>

</td>
</tr>
<tr id="AuthenticationPolicy.peers">
<td><code>peers</code></td>
<td><code><a href="#AuthenticationMechanism">AuthenticationMechanism[]</a></code></td>
<td>
<p>List of credential that should be checked by peer authentication. They
will be validated in sequence, until the first one satisfied. If none of
the specified mechanism valid, the whole authentication should fail.
On the other hand, the first valid credential will be used to extract
peer identity (i.e the source.user attribute in the request to mixer).</p>

</td>
</tr>
<tr id="AuthenticationPolicy.end_users">
<td><code>endUsers</code></td>
<td><code><a href="#AuthenticationMechanism">AuthenticationMechanism[]</a></code></td>
<td>
<p>Similar to above, but for end_user authentication, which will extract
request.auth.principal/audiences/presenter if authentication succeed.</p>

</td>
</tr>
</table>
</section>
<h2 id="Jwt">Jwt</h2>
<section>
<p>JSON Web Token (JWT) token format for authentication as defined by
https://tools.ietf.org/html/rfc7519. See <a href="https://tools.ietf.org/html/rfc6749">OAuth
2.0</a> and <a href="http://openid.net/connect">OIDC
1.0</a> for how this is used in the whole
authentication flow.</p>

<p>Example,</p>

<pre><code>issuer: https://example.com
audiences:
- bookstore_android.apps.googleusercontent.com
  bookstore_web.apps.googleusercontent.com
jwks_uri: https://example.com/.well-known/jwks.json
</code></pre>

<table>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
<tr id="Jwt.issuer">
<td><code>issuer</code></td>
<td><code>string</code></td>
<td>
<p>Identifies the issuer that issued the JWT. See
https://tools.ietf.org/html/rfc7519#section-4.1.1
Usually a URL or an email address.</p>

<p>Example: https://securetoken.google.com
Example: 1234567-compute@developer.gserviceaccount.com</p>

</td>
</tr>
<tr id="Jwt.audiences">
<td><code>audiences</code></td>
<td><code>string[]</code></td>
<td>
<p>The list of JWT
<a href="https://tools.ietf.org/html/rfc7519#section-4.1.3">audiences</a>.
that are allowed to access. A JWT containing any of these
audiences will be accepted.</p>

<p>The service name will be accepted if audiences is empty.</p>

<p>Example:</p>

<pre><code>audiences:
- bookstore_android.apps.googleusercontent.com
  bookstore_web.apps.googleusercontent.com
</code></pre>

</td>
</tr>
<tr id="Jwt.jwks_uri">
<td><code>jwksUri</code></td>
<td><code>string</code></td>
<td>
<p>URL of the provider&rsquo;s public key set to validate signature of the
JWT. See <a href="https://openid.net/specs/openid-connect-discovery-1_0.html#ProviderMetadata">OpenID
Discovery</a>.</p>

<p>Optional if the key set document can either (a) be retrieved from
<a href="https://openid.net/specs/openid-connect-discovery-1_0.html">OpenID
Discovery</a> of
the issuer or (b) inferred from the email domain of the issuer (e.g. a
Google service account).</p>

<p>Example: https://www.googleapis.com/oauth2/v1/certs</p>

</td>
</tr>
<tr id="Jwt.jwt_headers">
<td><code>jwtHeaders</code></td>
<td><code>string[]</code></td>
<td>
<p>JWT is sent in a request header. <code>header</code> represents the
header name.</p>

<p>For example, if <code>header=x-goog-iap-jwt-assertion</code>, the header
format will be x-goog-iap-jwt-assertion: <JWT>.</p>

</td>
</tr>
<tr id="Jwt.jwt_params">
<td><code>jwtParams</code></td>
<td><code>string[]</code></td>
<td>
<p>JWT is sent in a query parameter. <code>query</code> represents the
query parameter name.</p>

<p>For example, <code>query=jwt_token</code>.</p>

</td>
</tr>
</table>
</section>
<h2 id="MutualTls">MutualTls</h2>
<section>
<p>Place holder for mTLS authentication params.</p>

</section>
<h2 id="None">None</h2>
<section>
<p>Place holder for None authentication params</p>

</section>
