---
title: Authentication Policy v1alpha2
description: Authentication policy for Istio services.
location: https://istio.io/docs/reference/config/istio.authentication.v1alpha2.html
layout: protoc-gen-docs
generator: protoc-gen-docs
number_of_entries: 12
---
<p>This package defines user-facing authentication policy.</p>

<h2 id="AuthenticationMethod">AuthenticationMethod</h2>
<section>
<p>AuthenticationMethod describes the authentication method to be enforced. This specification is
used for both peer and origin authentication (see more in <code>AuthentiationRule</code>), though there is
restriction what method can be used for each type of authentication. For example, as of speaking,
origin  authentication can use only JWT. This logic will be enforced by validation. System will
also properly ignore the invalid ones.</p>

<table class="message-fields">
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr id="AuthenticationMethod-mtls" class="oneof oneof-start">
<td><code>mtls</code></td>
<td><code><a href="#MutualTls">MutualTls (oneof)</a></code></td>
<td>
<p>Set if Mutual TLS is used.</p>

</td>
</tr>
<tr id="AuthenticationMethod-jwt" class="oneof">
<td><code>jwt</code></td>
<td><code><a href="#Jwt">Jwt (oneof)</a></code></td>
<td>
<p>Set if JWT is used.</p>

</td>
</tr>
</tbody>
</table>
</section>
<h2 id="AuthenticationPolicy">AuthenticationPolicy</h2>
<section>
<p>AuthenticationPolicy describes authentication requirements for the workload(s) it is attached to.
Example of a simple policy that enable mTLS for all workloads in the namespace scope of the
policy. Note that <code>istio.mtls</code> is a name of the pre-define <code>AuthenticationMethod</code> for Istio
mutual TLS.</p>

<pre><code>spec:
  policy:
    peers:
    - authentication:
        method: &quot;istio.mtls&quot;
</code></pre>

<p>This example set end-user authentication for workloads that match label <code>app</code>=<code>foo</code>, using JWT
The JWT authentication details are defined directly in the policy (<code>inline</code>).</p>

<pre><code>spec:
  workloadSelector:
    app: foo
  policy:
    origins:
    - apply:
        spec:
          jwt:
            issuer: &quot;https://securetoken.google.com&quot;
            audiences:
            - &quot;productpage&quot;
            jwksUri: &quot;https://www.googleapis.com/oauth2/v1/certs&quot;
</code></pre>

<p>This last example shows a policy to set peer authentication with mTLS for all requests, and
end-user authentication if requests have &ldquo;/create&rdquo; or &ldquo;/update&rdquo; prefix. For all other paths,
end-user authentication is not required (though peer mTLS still needed)</p>

<pre><code>spec:
  workloadSelector:
    app: bar
  policy:
    peers:
    - authentication:
        method: &quot;istio.mtls&quot;
    origins:
    - match:
        paths:
        - prefix: &quot;/create&quot;
        - prefix: &quot;/update&quot;
      authentication:
        method: &quot;my-jwt&quot;
</code></pre>

<table class="message-fields">
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr id="AuthenticationPolicy-workload_selector">
<td><code>workloadSelector</code></td>
<td><code><a href="#istio-common-v1beta1-WorkloadSelector">istio.common.v1beta1.WorkloadSelector</a></code></td>
<td>
<p>Criteria used to select the specific set of pods/VMs on which this
authentication policy should be applied. If omitted, the authentication policy
be applied to all workload instances in the same namespace.</p>

</td>
</tr>
<tr id="AuthenticationPolicy-policy">
<td><code>policy</code></td>
<td><code><a href="#PolicyContent">PolicyContent</a></code></td>
<td>
<p>REQUIRED. The authentication spec to be set for the selected workloads.</p>

</td>
</tr>
</tbody>
</table>
</section>
<h2 id="AuthenticationRule">AuthenticationRule</h2>
<section>
<p>AuthenticationRule describes match conditions and the corresponding authentication action. See
AuthenticationPolicy for example.</p>

<table class="message-fields">
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr id="AuthenticationRule-match">
<td><code>match</code></td>
<td><code><a href="#Match">Match[]</a></code></td>
<td>
<p>Define the conditions when the authentication mechanism will be activated.
All conditions must be satisfied (ANDed) for the authentication mechanism
to be used. If empty, it matches all requests.</p>

</td>
</tr>
<tr id="AuthenticationRule-authentication">
<td><code>authentication</code></td>
<td><code><a href="#AuthenticationRule-AuthenticationMethodReference">AuthenticationRule.AuthenticationMethodReference</a></code></td>
<td>
<p>REQUIRED. Authentication method to be used if the match conditions are satisfied.</p>

</td>
</tr>
</tbody>
</table>
</section>
<h2 id="AuthenticationRule-AuthenticationMethodReference">AuthenticationRule.AuthenticationMethodReference</h2>
<section>
<p>AuthenticationMethodReference refers to <code>AuthenticationMethod</code> by name or define it inline.</p>

<table class="message-fields">
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr id="AuthenticationRule-AuthenticationMethodReference-method" class="oneof oneof-start">
<td><code>method</code></td>
<td><code>string (oneof)</code></td>
<td>
<p>Refers to the AuthenticationMethod CR with this name.
If the AuthenticationMethod resource with this name does not exist,
Istio (Pilot) will log errors and also configures proxy with method
that is equivalent to <code>deny-all</code>.</p>

</td>
</tr>
<tr id="AuthenticationRule-AuthenticationMethodReference-spec" class="oneof">
<td><code>spec</code></td>
<td><code><a href="#AuthenticationMethod">AuthenticationMethod (oneof)</a></code></td>
<td>
<p>Defines the required authentication method inline.</p>

</td>
</tr>
</tbody>
</table>
</section>
<h2 id="Jwt">Jwt</h2>
<section>
<p>JSON Web Token (JWT) token format for authentication as defined by
<a href="`https://tools.ietf.org/html/rfc7519`">RFC 7519</a>. See <a href="`https://tools.ietf.org/html/rfc6749`">OAuth
2.0</a> and <a href="`http://openid.net/connect`">OIDC
1.0</a> for how this is used in the whole
authentication flow.</p>

<p>For example:</p>

<p>A JWT for any requests:</p>

<pre><code class="language-yaml">issuer: https://example.com
audiences:
- bookstore_android.apps.googleusercontent.com
  bookstore_web.apps.googleusercontent.com
jwksUri: https://example.com/.well-known/jwks.json
</code></pre>

<table class="message-fields">
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr id="Jwt-issuer">
<td><code>issuer</code></td>
<td><code>string</code></td>
<td>
<p>Identifies the issuer that issued the JWT. See
<a href="`https://tools.ietf.org/html/rfc7519#section-4.1.1`">issuer</a>
Usually a URL or an email address.</p>

<p>Example: <code>https://securetoken.google.com</code>
Example: <code>1234567-compute@developer.gserviceaccount.com</code></p>

</td>
</tr>
<tr id="Jwt-audiences">
<td><code>audiences</code></td>
<td><code>string[]</code></td>
<td>
<p>The list of JWT
<a href="`https://tools.ietf.org/html/rfc7519#section-4.1.3`">audiences</a>.
that are allowed to access. A JWT containing any of these
audiences will be accepted.</p>

<p>The service name will be accepted if audiences is empty.</p>

<p>Example:</p>

<pre><code class="language-yaml">audiences:
- bookstore_android.apps.googleusercontent.com
  bookstore_web.apps.googleusercontent.com
</code></pre>

</td>
</tr>
<tr id="Jwt-jwks_uri">
<td><code>jwksUri</code></td>
<td><code>string</code></td>
<td>
<p>URL of the provider&rsquo;s public key set to validate signature of the
JWT. See <a href="`https://openid.net/specs/openid-connect-discovery-1_0.html#ProviderMetadata`">OpenID Discovery</a>.</p>

<p>Optional if the key set document can either (a) be retrieved from
<a href="`https://openid.net/specs/openid-connect-discovery-1_0.html`">OpenID
Discovery</a> of
the issuer or (b) inferred from the email domain of the issuer (e.g. a
Google service account).</p>

<p>Example: <code>https://www.googleapis.com/oauth2/v1/certs</code></p>

<p>Note: Only one of <code>jwks_uri</code> and <code>jwks</code> should be used.</p>

</td>
</tr>
<tr id="Jwt-jwks">
<td><code>jwks</code></td>
<td><code>string</code></td>
<td>
<p>JSON Web Key Set of public keys to validate signature of the JWT.
See <code>https://auth0.com/docs/jwks</code></p>

<p>Note: Only one of <code>jwks_uri</code> and <code>jwks</code> should be used.</p>

</td>
</tr>
<tr id="Jwt-jwt_headers">
<td><code>jwtHeaders</code></td>
<td><code>string[]</code></td>
<td>
<p>JWT is sent in a request header. <code>header</code> represents the
header name.</p>

<p>For example, if <code>header=x-goog-iap-jwt-assertion</code>, the header
format will be <code>x-goog-iap-jwt-assertion</code>: $JWT.</p>

</td>
</tr>
<tr id="Jwt-jwt_params">
<td><code>jwtParams</code></td>
<td><code>string[]</code></td>
<td>
<p>JWT is sent in a query parameter. <code>query</code> represents the
query parameter name.</p>

<p>For example, <code>query=jwt_token</code>.</p>

</td>
</tr>
</tbody>
</table>
</section>
<h2 id="Match">Match</h2>
<section>
<p>Match specifies a set of criterion to be met in order for the rule to be applied.
For example, the following restricts mTLS being applied only on port 8080, and JWT
authentication if the request path starts with /get.</p>

<pre><code>spec:
  policy:
    peers:
    - match
        ports:
        - 8080
      method: istio.mtls
    origins:
    - match:
        paths:
        - prefix: &quot;/get&quot;
      method: example-jwt
</code></pre>

<table class="message-fields">
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr id="Match-ports">
<td><code>ports</code></td>
<td><code>uint32[]</code></td>
<td>
<p>Ports to match. If not specified, it matches to any port number.
Note: these are workload ports, not service ports.</p>

</td>
</tr>
<tr id="Match-paths">
<td><code>paths</code></td>
<td><code><a href="#istio-common-v1beta1-StringMatch">istio.common.v1beta1.StringMatch[]</a></code></td>
<td>
<p>Request path to match. Available for <code>L7</code> authentication method only (e.g JWT). If not
specified, it matches to any paths.
Values are case-sensitive and formatted as follows:</p>

<ul>
<li><p><code>exact: &quot;value&quot;</code> for exact string match</p></li>

<li><p><code>prefix: &quot;value&quot;</code> for prefix-based match</p></li>

<li><p><code>regex: &quot;value&quot;</code> for ECMAscript style regex-based match</p></li>
</ul>

</td>
</tr>
</tbody>
</table>
</section>
<h2 id="MutualTls">MutualTls</h2>
<section>
<p>Mutual TLS authentication parameters.</p>

<table class="message-fields">
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr id="MutualTls-mode">
<td><code>mode</code></td>
<td><code><a href="#MutualTls-Mode">MutualTls.Mode</a></code></td>
<td>
<p>Defines the mode of mTLS authentication.</p>

</td>
</tr>
</tbody>
</table>
</section>
<h2 id="MutualTls-Mode">MutualTls.Mode</h2>
<section>
<p>Defines the acceptable connection TLS mode.</p>

<table class="enum-values">
<thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr id="MutualTls-Mode-INVALID">
<td><code>INVALID</code></td>
<td>
<p>Must never be set.</p>

</td>
</tr>
<tr id="MutualTls-Mode-STRICT">
<td><code>STRICT</code></td>
<td>
<p>Client cert must be presented, connection is in TLS.</p>

</td>
</tr>
<tr id="MutualTls-Mode-PERMISSIVE">
<td><code>PERMISSIVE</code></td>
<td>
<p>Connection can be either plain text or TLS, and client cert can be omitted.</p>

</td>
</tr>
</tbody>
</table>
</section>
<h2 id="PolicyContent">PolicyContent</h2>
<section>
<p>PolicyContent specifies the authentication requirements. It is composed of 2-part authentication:
- peer: verify caller service credentials. This part will set <code>source.principal</code>
(peer identity).
- origin: verify the origin credentials. This part will set <code>request.auth.user</code>
(origin identity), as well as other attributes like <code>request.auth.presenter</code>,
<code>request.auth.audiences</code> and raw claims. Note that the identity could be
end-user, service account, device etc.</p>

<p>Last but not least, the principal binding rule defines which identity (peer
or origin) should be used as principal. By default, it uses peer.
For examples, see <code>AuthenticationPolicy</code></p>

<table class="message-fields">
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr id="PolicyContent-peers">
<td><code>peers</code></td>
<td><code><a href="#AuthenticationRule">AuthenticationRule[]</a></code></td>
<td>
<p>List of authentication methods that can be used for peer authentication.
Rule will be examined in order. Each rule may contain match conditions.
The first (and only) rule that have the match conditions satisfied will
be activated, and the authentication result decides whether the request is
allowed or denied. In other words, all other rules are ignored. If
there is no rule meet the conditions, or if the list is empty,
authentication is not required.</p>

</td>
</tr>
<tr id="PolicyContent-origins">
<td><code>origins</code></td>
<td><code><a href="#AuthenticationRule">AuthenticationRule[]</a></code></td>
<td>
<p>List of authentication methods that can be used for origin authentication.
See <code>peers</code> for more details.</p>

</td>
</tr>
<tr id="PolicyContent-principal_binding">
<td><code>principalBinding</code></td>
<td><code><a href="#PrincipalBinding">PrincipalBinding</a></code></td>
<td>
<p>Define whether peer or origin identity should be used for request principal.
Default value is USE_PEER.
If peer (or origin) identity is not available, either because of peer/origin
authentication is not defined, or failed, principal will be left unset.
In other words, binding rule does not affect the decision to accept or
reject request.</p>

</td>
</tr>
</tbody>
</table>
</section>
<h2 id="PrincipalBinding">PrincipalBinding</h2>
<section>
<p>Associates authentication with request principal.</p>

<table class="enum-values">
<thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr id="PrincipalBinding-USE_PEER">
<td><code>USE_PEER</code></td>
<td>
<p>Principal will be set to the identity from peer authentication.</p>

</td>
</tr>
<tr id="PrincipalBinding-USE_ORIGIN">
<td><code>USE_ORIGIN</code></td>
<td>
<p>Principal will be set to the identity from origin authentication.</p>

</td>
</tr>
</tbody>
</table>
</section>
<h2 id="istio-common-v1beta1-StringMatch">istio.common.v1beta1.StringMatch</h2>
<section>
<p>Describes how to match a given string. Match is case-sensitive.</p>

<table class="message-fields">
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr id="istio-common-v1beta1-StringMatch-exact" class="oneof oneof-start">
<td><code>exact</code></td>
<td><code>string (oneof)</code></td>
<td>
<p>exact string match.</p>

</td>
</tr>
<tr id="istio-common-v1beta1-StringMatch-prefix" class="oneof">
<td><code>prefix</code></td>
<td><code>string (oneof)</code></td>
<td>
<p>prefix-based match.</p>

</td>
</tr>
<tr id="istio-common-v1beta1-StringMatch-suffix" class="oneof">
<td><code>suffix</code></td>
<td><code>string (oneof)</code></td>
<td>
<p>suffix-based match.</p>

</td>
</tr>
<tr id="istio-common-v1beta1-StringMatch-regex" class="oneof">
<td><code>regex</code></td>
<td><code>string (oneof)</code></td>
<td>
<p><code>ECMAscript</code> style regex-based match as defined by <a href="`http://en.cppreference.com/w/cpp/regex/ecmascript`"><code>EDCA-262</code></a>.
Example: &ldquo;^/pets/(.*?)?&rdquo;</p>

</td>
</tr>
</tbody>
</table>
</section>
<h2 id="istio-common-v1beta1-WorkloadSelector">istio.common.v1beta1.WorkloadSelector</h2>
<section>
<p>WorkloadSelector specifies the criteria used to determine if a resource can be applied to a
workload (proxy).</p>

<table class="message-fields">
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr id="istio-common-v1beta1-WorkloadSelector-labels">
<td><code>labels</code></td>
<td><code>map&lt;string,&nbsp;string&gt;</code></td>
<td>
<p>REQUIRED: One or more labels that indicate a specific set of pods/VMs. The scope of
label search is restricted to the configuration namespace in which the resource is present.</p>

</td>
</tr>
</tbody>
</table>
</section>
